\section{Experiments}
\label{sec:experiments}

\subsection{Experimental setup}

Our network were build using using Keras \cite{chollet2015keras} with Tensorflow \cite{tensorflow2015-whitepaper}. We used a pre-trained VGG16 model to initialize the weights. Also, we use SGD optimization with learning rate set to 1e-4, decay of 1e-6 and momentum of 0.95. Other experiments with different values will be discussed in next sections. All training experiments were performed in GeForce GTX 1080 8GB GPU.

To increase the number of images in the training set, we made some data augmentation procedures. The techniques we used was pepper noise, horizontal flipping (mirror), changes in contrast and brightness. These procedures resulted in 1445 images, splited in 1228 samples for training and 217 validate samples (about 15\%).

\subsection{The Kitti Road/Lane dataset}

KITTI Road/Lane Dataset, part of KITTI Vision Benchmarking Suite, contains  images for road and lane estimation. Consists of 289 training and 290 test images . Ground truth is manually annotated for two different road types: road - road area (the composition of all lanes), and lane (the ego-lane; lane the vehicle is currently driving on) \cite{KITTI}. 

In this paper, we use only the road ground-truths and ignore lane annotations. Some images contains two different ground-truths, one for lane and other for road. Then, we prefer to use road estimation and build only one classifier. Also, it is important to say that ground truth is only available for training set. The test evaluation should be performed using KITTI Server \cite{KITTI}. 

The results in this paper were performed using KITTI Road Evaluation Benchmark, provided with KITTI Road Dataset. %The results in test set were performed by KITTI Server.

\subsection{Results}

In training evaluation, it was noticed that the network was more stable, and we can set bigger learning rates parameters ($1 \times 10^3$). Also, we can use different optimizers and Nesterov Optimization \cite{Nesterov:1983wy}.

\begin{figure}
  \centering
  \includegraphics[width=0.48\textwidth]{figures/val_acc.png}
  \caption{Validation accuracy}
  \label{fig:val_accuracy}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.48\textwidth]{figures/val_loss.png}
  \caption{Validation loss}
  \label{fig:val_loss}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.48\textwidth]{figures/train_time.png}
  \caption{Average training time}
  \label{fig:train_time}
\end{figure}

\begin{table}
  \begin{tabular}{{c}{c}{c}{c}{c}{c}{c}}
  
  \multicolumn{7}{l}{Stage Layer Outputs - Without Matematical Morfology} \\
  \hline 
    Category & MaxF & AP & PRE & REC & FPR & FNR \\
  \hline
    \textit{um\_road} & 96.92\% & 87.36\% & 94.47\% & 99.49\% & 1.13\% & 0.51\% \\
    \textit{umm\_road} & 97.57\% & 89.44\% & 96.05\% & 99.15\% & 1.24\% & 0.85\% \\
    \textit{uu\_road} & 95.16\% & 85.73\% & 92.94\% & 97.49\% & 1.16\% & 2.51\% \\
  \hline
  \multicolumn{7}{c}{} \\
  
  \multicolumn{7}{l}{Stage Layer Outputs - With Matematical Morfology} \\
  \hline 	
    Category & MaxF & AP & PRE & REC & FPR & FNR \\
  \hline
    \textit{um\_road} & 97.01\% & 87.68\% & 94.83\% & 99.30\% & 1.05\% & 0.70\% \\
    \textit{umm\_road} & 97.61\% & 89.67\% & 96.30\% & 98.97\% & 1.16\% & 1.03\% \\
    \textit{uu\_road} & 95.42\% & 86.48\% & 93.77\% & 97.13\% & 1.01\% & 2.87\% \\
  \hline
  \multicolumn{7}{c}{} \\
  
  \multicolumn{7}{l}{All Layers Outputs - Without Matematical Morfology} \\
  \hline 	
    Category & MaxF & AP & PRE & REC & FPR & FNR \\
  \hline
    \textit{um\_road} & 96.39\% & 86.81\% & 93.87\% & 99.05\% & 1.25\% & 0.95\% \\
    \textit{umm\_road} & 97.05\% & 88.83\% & 95.37\% & 98.78\% & 1.46\% & 1.22\% \\
    \textit{uu\_road} & 94.70\% & 84.87\% & 92.00\% & 97.56\% & 1.33\% & 2.44\% \\
  \hline
  \multicolumn{7}{c}{} \\
  
  \multicolumn{7}{l}{All Layers Outputs - With Matematical Morfology} \\
  \hline 	
    Category & MaxF & AP & PRE & REC & FPR & FNR \\
  \hline
    \textit{um\_road} & 96.65\% & 87.51\% & 94.64\% & 98.74\% & 1.08\% & 1.26\% \\
    \textit{umm\_road} & 97.21\% & 89.31\% & 95.90\% & 98.56\% & 1.29\% & 1.44\% \\
    \textit{uu\_road} & 95.20\% & 86.15\% & 93.40\% & 97.08\% & 1.08\% & 2.92\% \\
  \hline
  
  \end{tabular}
  \caption{KITTI benchmark evaluation results for in each category \protect\footnotemark}
  \label{table:max_without_morf}
\end{table}

\footnotetext{Table abbreviations: \textit{MaxF}: Maximum F1-measure, \textit{AP}: Average precision, \textit{PRE}: Precision, \textit{REC}: Recall, \textit{FPR}: False Positive Rate, \textit{FNR}: False Negative Rate}

\begin{comment}
HED
Closing for i in range(3, 8, 1):


\end{comment}

\subsection{Qualitative analysis}
